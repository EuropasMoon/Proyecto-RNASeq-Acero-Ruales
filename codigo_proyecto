# Código del proyecto final de bioinformatica 
# Revisión de calidad
module load fastqc/0.11.7
fastqc /home/reads/*.gz

#eliminar kmeros erroneos 
for i in $(cat names.txt)
do
run_rcorrector.pl -t 10 -1 "$i"_R1.fastq.gz -2 "$i"_R2.fastq.gz -od filtered_reads
done 

#filtrar secuencias incorregibles 
ls *R1.cor.fq.gz > names.txt

module load python/2.7.10
for i in $(cat names.txt)
do 
python2 /opt/ohpc/pub/apps/TranscriptomeAssemblyTools/FilterUncorrectabledPEfastq.py -1 "$i"_R1.cor.fq.gz -2 "$i"_R2.cor.fq.gz -s "sufix"
done 

#Quitar adaptadores con TrimGalore 
for i in $(cat nombres.txt)
do trim_galore --cores 10 --phred33 --output_dir output_rmadapt --length 36 -q 5 --stringency 1 -e 0.1 --fastqc ./"$i"
done
